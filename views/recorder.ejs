<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Sentiment Recorder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/recorder.css">
  </head>
  <body>

    <section class="record"></section>
    <h1>Add A Sentiment</h1>
    <p>Here you can record your voice memos which can be added to your existing playlist. 
        Press "Record" to begin. Once you are finished press "Stop". If for any reason you need to pause you may press "Pause/Resume" when ready. 
     </p>
     <p>Your recording will be available for preview below. Download this recording and press Upload Track </p>
    <div id="controls">
  	 <button id="recordButton">Record</button>
  	 <button id="pauseButton" disabled>Pause</button>
  	 <button id="stopButton" disabled>Stop</button>
    </div>
    <div id="formats">Format: start recording to see sample rate</div>
  	<!-- <p><strong>Recordings:</strong></p> -->
  	<ol id="recordingsList"></ol>
    <!-- inserting these scripts at the end to be able to use all the elements in the DOM -->
  </section>

  	<script src="https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js"></script>
  	<script src="/recorder.js"></script>

  <form action="/upload" method="POST" enctype="multipart/form-data">
  
  <label >Upload A Track</label>
  <input type="file" name="audio_data">
    <button type="submit">Upload Track</button>
<input type="hidden" name='type' value="song">
  </form>

  
<a href="/player/<%=user._id%>"><span id="playlistUrl"></span></a>

  <ul class="messages">
    <% for(var i=0; i<audioFiles.length; i++) {%>
      <li class="audio">
        <span><%= audioFiles[i].title %></span>
        <span><%= audioFiles[i].type %></span>
        <audio controls="controls" autobuffer="autobuffer">
            <source src="data:audio/wav;base64,<%=audioFiles[i].audioData.toString('base64')%>" />
        </audio>
        <span><i class="fa fa-thumbs-up" aria-hidden="true"></i></span>
        <span><i class="fa fa-thumbs-down" aria-hidden="true"></i></span>
        <span><i class="fa fa-trash" aria-hidden="true"></i></span>
        
      </li>
    <% } %>

    </ul>
    
    <script>
      document.getElementById('playlistUrl').innerHTML = window.location.href + '/../player/<%= user._id%>'
    </script>

  </body>
</html>